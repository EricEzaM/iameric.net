{"componentChunkName":"component---src-templates-snippet-jsx","path":"/snippets/excel-filename-from-filepath","result":{"data":{"snippet":{"html":"<p>Oftentimes in my work I find myself needing to check if a particular file is in some directory or it's subdirectories. Usually you can do a simple Windows Explorer search, or even use a more powerful tool like <a href=\"https://antibody-software.com/wizfile/\">WizFile</a> to perform faster searches. But what if you have a big list of file names and need to see if they exist in a directory? In this case we can use Excel and a VLOOKUP to help us - but first you need to get all the file names from the paths...</p>\n<div class=\"gatsby-highlight\" data-language=\"xlsx\"><pre class=\"language-xlsx\"><code class=\"language-xlsx\"><span class=\"token operator\">=</span> <span class=\"token function-name keyword\">RIGHT</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">A1</span><span class=\"token operator\">,</span> <span class=\"token function-name keyword\">LEN</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">A1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token function-name keyword\">FIND</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"*\"</span><span class=\"token operator\">,</span> <span class=\"token function-name keyword\">SUBSTITUTE</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">A1</span><span class=\"token operator\">,</span> <span class=\"token string\">\"\\\"</span><span class=\"token operator\">,</span> <span class=\"token string\">\"*\"</span><span class=\"token operator\">,</span> <span class=\"token function-name keyword\">LEN</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">A1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token function-name keyword\">LEN</span><span class=\"token punctuation\">(</span><span class=\"token function-name keyword\">SUBSTITUTE</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">A1</span><span class=\"token operator\">,</span> <span class=\"token string\">\"\\\"</span><span class=\"token operator\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 357px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.539877300613497%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA4ElEQVQY05WP627CMAyF+/5vweMMddVUAm2SFtofm9hExQRrLs3lzMlAE9qvWTqxY8Un/oplWWCthff+XzLGwDuPGANSOOeyCqsVNjUD2+6wflpDa4PHiI8p/hT7rsdL9YyyLGl+k83SR2SoMQwjpBRomxZCcAjO0TQ7qgXk4UAaIPcdRN/j9XiEJ9O3j3c0fQdO77mQmTLRFsl5nmcopWg7nXO633vnusZ1HKE+z/g6naCmCZ761y3DtFpBXy7Qxv4ipyOEkFH+iNACGTjGsFQV7E2GME3bwtO28TZ7N/wGQWB8fXl/43cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Example\"\n        title=\"Example\"\n        src=\"/static/78b6dbef523e46d0dcf4ad93428e1f94/22d0a/example.png\"\n        srcset=\"/static/78b6dbef523e46d0dcf4ad93428e1f94/222b7/example.png 163w,\n/static/78b6dbef523e46d0dcf4ad93428e1f94/ff46a/example.png 325w,\n/static/78b6dbef523e46d0dcf4ad93428e1f94/22d0a/example.png 357w\"\n        sizes=\"(max-width: 357px) 100vw, 357px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<blockquote>\n<p>If you need to get a list of all file paths in a directory and sub-directories, open command prompt and navigate to the folder. Then run <code class=\"language-text\">dir /s /b > FileList.txt</code>, and you will get a new file, \"FileList.txt\" in that folder with the paths of every file and folder!</p>\n</blockquote>\n<h3>Explanation</h3>\n<p>The approach here is to replace the last slash with an asterisk, which will mark where the file name starts. Then we can just take everything after that asterisk as the file name. On Windows, an asterisk cannot be in a filepath so it is a good character to use to 'mark' where the filename starts.</p>\n<p><code class=\"language-text\">SUBSTITUTE</code> has an optional parameter <code class=\"language-text\">instance_num</code>, which allows you to determine which instance of the \"old text\" you want to replace. For example, if I did <code class=\"language-text\">SUBSTITUTE(\"food\", \"o\", \"*\", 2)</code>, it would replace only the second \"o\" with an asterisk \"*\", and the result would be <code class=\"language-text\">fo*d</code>. So, the way we get the number of slashes is by subtracting the length of the text <em>with slashes removed</em> from the length of the original text. Again, with the example above, if I remove the o's from \"food\": <code class=\"language-text\">LEN(\"food\") - LEN(\"fd\") = 2</code>, so there are 2 o's in \"food\".</p>\n<div class=\"gatsby-highlight\" data-language=\"xlsx\"><pre class=\"language-xlsx\"><code class=\"language-xlsx\">Number of Slashes <span class=\"token operator\">=</span> <span class=\"token function-name keyword\">LEN</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">A1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token function-name keyword\">LEN</span><span class=\"token punctuation\">(</span><span class=\"token function-name keyword\">SUBSTITUTE</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">A1</span><span class=\"token operator\">,</span><span class=\"token string\">\"\\\"</span><span class=\"token operator\">,</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\nText with last slash replaced <span class=\"token operator\">=</span> <span class=\"token function-name keyword\">SUBSTITUTE</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">A1</span><span class=\"token operator\">,</span><span class=\"token string\">\"\\\"</span><span class=\"token operator\">,</span><span class=\"token string\">\"*\"</span><span class=\"token operator\">,</span> <span class=\"token function-name keyword\">LEN</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">A1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token function-name keyword\">LEN</span><span class=\"token punctuation\">(</span><span class=\"token function-name keyword\">SUBSTITUTE</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">A1</span><span class=\"token operator\">,</span><span class=\"token string\">\"\\\"</span><span class=\"token operator\">,</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Finally, we take the text after the asterisk as the file name.</p>\n<div class=\"gatsby-highlight\" data-language=\"xlsx\"><pre class=\"language-xlsx\"><code class=\"language-xlsx\"><span class=\"token operator\">=</span> <span class=\"token function-name keyword\">RIGHT</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">B2</span><span class=\"token operator\">,</span> <span class=\"token function-name keyword\">LEN</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">B2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token function-name keyword\">FIND</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"*\"</span><span class=\"token operator\">,</span> <span class=\"token operator\">&lt;</span>Text with last slash replaced<span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>This can also be done with <code class=\"language-text\">MID</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"xlsx\"><pre class=\"language-xlsx\"><code class=\"language-xlsx\"><span class=\"token operator\">=</span> <span class=\"token function-name keyword\">MID</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">A1</span><span class=\"token operator\">,</span> <span class=\"token function-name keyword\">FIND</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"*\"</span><span class=\"token operator\">,</span> <span class=\"token operator\">&lt;</span>Text with last slash replaced<span class=\"token operator\">></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token operator\">,</span> <span class=\"token function-name keyword\">LEN</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">B2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Putting all that together gives you the full formula:</p>\n<div class=\"gatsby-highlight\" data-language=\"xlsx\"><pre class=\"language-xlsx\"><code class=\"language-xlsx\"><span class=\"token operator\">=</span> <span class=\"token function-name keyword\">RIGHT</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">A1</span><span class=\"token operator\">,</span> <span class=\"token function-name keyword\">LEN</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">A1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token function-name keyword\">FIND</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"*\"</span><span class=\"token operator\">,</span> <span class=\"token function-name keyword\">SUBSTITUTE</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">A1</span><span class=\"token operator\">,</span> <span class=\"token string\">\"\\\"</span><span class=\"token operator\">,</span> <span class=\"token string\">\"*\"</span><span class=\"token operator\">,</span> <span class=\"token function-name keyword\">LEN</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">A1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token function-name keyword\">LEN</span><span class=\"token punctuation\">(</span><span class=\"token function-name keyword\">SUBSTITUTE</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">A1</span><span class=\"token operator\">,</span> <span class=\"token string\">\"\\\"</span><span class=\"token operator\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<blockquote>\n<p><strong>Note:</strong> If the cell only contains a file name with no slashes (e.g. \"MyFile.txt\"), the result will be a <code class=\"language-text\">#VALUE</code> error because no slash \"\\\" can be found. This can be resolved by wrapping the whole formula in an <code class=\"language-text\">IFERROR</code> function.</p>\n</blockquote>","frontmatter":{"title":"Getting a file name from a file path in Excel","category":"Excel","date":"Sunday February 14th, 2021"}}},"pageContext":{"slug":"excel-filename-from-filepath"}},"staticQueryHashes":["1277554887","63159454"]}